on: pull_request

env:
  PUSHOVER_TOKEN: ${{ secrets.PUSHOVER_TOKEN }}
  PUSHOVER_USER: ${{ secrets.PUSHOVER_USER }}

jobs:
  lint-code:
    runs-on: self-hosted
    name: PingMe
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: golangci-lint
        uses: golangci/golangci-lint-action@v2
        with:
          version: v1.29

      - name: Notification for checks failure
        uses: kha7iq/pingme-action@v1
        if: failure()
        env:
          PUSHOVER_TITLE: 'üü¢ New Request: ${{ github.ref }}'
          PUSHOVER_MESSAGE: 'Event is triggerd by ${{ github.event_name }} Checks  ‚ùå  ${{ job.status }}'
        with:
          service: pushover

      - name: Notification for checks passing
        uses: kha7iq/pingme-action@v1
        if: success()
        env:
          PUSHOVER_TITLE: 'üü¢ New Request: ${{ github.ref }}'
          PUSHOVER_MESSAGE: 'Event is triggerd by ${{ github.event_name }} Checks ‚úÖ  ${{ job.status }}'
        with:
          service: pushover
